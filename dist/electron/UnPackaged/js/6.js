(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"11dc":function(t,e,a){},"316f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"credit-container q-pa-sm",class:{electron:t.isElectron}},["signedIn"===t.currentState?a("div",[a("actions",{staticStyle:{width:"100%","max-width":"960px",margin:"4px 4px"}}),a("task",{staticStyle:{width:"100%","max-width":"960px",margin:"4px 4px"}}),a("income",{staticStyle:{width:"100%","max-width":"960px",margin:"4px 4px"}}),a("expense",{staticStyle:{width:"100%","max-width":"960px",margin:"4px 4px"}})],1):t._e()])},i=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{attrs:{bordered:"",flat:""}},[a("q-card-section",{staticClass:"row items-center overflow-hidden non-selectable"},[a("div",{staticClass:"text-h6 text-weight-bold ellipsis"},[t._v(t._s(t.$t("credits")))]),a("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",round:"",size:"0.7rem"},on:{click:function(){return t.openBrowser("https://alpha.biz/blog/how-to-get-more-ab-credits/")}}},[a("q-icon",{attrs:{name:"help_outline"}}),a("q-tooltip",[t._v(t._s(t.$t("credit_get_more")))])],1)],1),a("q-separator"),a("q-card-section",{staticClass:"column items-center non-selectable"},[a("div",{staticStyle:{"font-size":"0.8rem"}},[t._v(t._s(t.$t("your_credits")))]),a("div",{staticClass:"text-h4 text-weight-bolder",attrs:{"data-cy":"currentCredit"}},[t._v(t._s(t.currentCredit))])]),a("q-card-section",{staticClass:"row justify-start credit-actions q-pt-none overflow-hidden"},[a("q-btn",{attrs:{unelevated:"",color:"general","text-color":"general","no-wrap":"","no-caps":"",disable:!!t.currentLoadingState,loading:"transfer"===t.currentLoadingState,label:t.$t("transfer")},on:{click:t.transfer}}),a("q-btn",{attrs:{unelevated:"",color:"general","text-color":"general","no-wrap":"","no-caps":"",disable:!!t.currentLoadingState,loading:"receive"===t.currentLoadingState,label:t.$t("receive")},on:{click:t.receive}}),a("q-btn",{attrs:{unelevated:"",color:"general","text-color":"general","no-wrap":"","no-caps":"",disable:!!t.currentLoadingState||!t.showWithdraw,loading:"withdraw_fund"===t.currentLoadingState,label:t.$t("withdraw_fund")},on:{click:t.withdrawFund}},[t.showWithdraw?a("q-badge",{attrs:{color:"positive",floating:"",label:t.providentFundValue}}):t._e()],1),t.$store.getters.isDevMode?t._l(t.testHandlers,(function(e,n){return a("q-btn",{key:n,attrs:{unelevated:"",color:"general","text-color":"general","no-wrap":"","no-caps":"",disable:!!t.currentLoadingState,loading:t.currentLoadingState===n,label:n},on:{click:e}})})):t._e(),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i"),a("i")],2)],1)},r=[],o=(a("7a76"),a("06e8")),c={data(){return{txn$fetcher:Object(o["c"])(),txn$data:{},txn$hasNext:void 0}},methods:{async txn$query(t,e){return t&&this.txn$fetcher.reset({query_type:t,query_params:e}),!!this.txn$fetcher.hasNext()&&(await this.txn$fetcher.fetch(),this.txn$data=this.txn$fetcher.getData().reduce(((t,e)=>(t[e.id]=e,t)),{}),this.txn$hasNext=this.txn$fetcher.hasNext(),!0)}}},l=a("072b"),d=a("aa8a"),u={name:"Actions",mixins:[c],data(){return{currentLoadingState:null}},computed:{currentState(){return this.$store.state.account.authState?"signedIn"!==this.$store.state.account.authState?"signedOut":"signedIn":"loading"},currentCredit(){return"signedIn"===this.currentState&&this.$store.state.credits.credit?this.$store.state.credits.credit/1e3:0},showWithdraw(){var t;return"signedIn"===this.currentState&&!(null===(t=this.$store.state.credits.providentFund)||void 0===t||!t.value)},providentFundValue(){if(!this.$store.state.credits.providentFund)return 0;const t=this.$store.state.credits.providentFund.value/1e3;return t>999?"999+":t>99?"99+":t},testHandlers(){const t=(t,e)=>async()=>{try{this.currentLoadingState=t,await e()}finally{this.currentLoadingState=null}},e=e=>Object.keys(e).reduce(((a,n)=>(a[n]=t(n,e[n]),a)),{});return e({pf$deposit_10:async()=>{await this.$store.dispatch("CREDIT_PF_DEPOSIT",{amount:1e4,meta:{testInfoHash:"foobar"}})},query$income:async()=>{await this.txn$query("income")},query$next:async()=>{await this.txn$query()},gql$query:async()=>{const t=global.gqlAPI.AwsApiGraphQL.injectAllOperations({}),e=await t.getUser(this.$store.state.account.sub);console.log(e)}})}},watch:{txn$data(t){console.log(Object.keys(t).length,t)}},methods:{async transfer(){const t=async t=>{const e={required:t=>!!t||this.$t("account_is_required")},a={receiver:{type:"text",model:"",icon:"qr_code",label:this.$t("receipt_code"),rules:[e.required,l["g"].bind(this)]},amount:{type:"text",model:"",icon:"paid",label:this.$t("transfer_amount"),rules:[e.required,l["f"].bind(this)]}},n=this.$alphabiz.dialog({title:this.$t("transfer"),message:this.$t("fill_the_receipt_code"),prompts:a,cancel:!0,ok:{color:"primary",textColor:"primary",label:this.$t("transfer"),handler:()=>n.vm.dialog$useLoadingState("ok",(async e=>{const{prompts:a}=e.dialog$arguments();await t(e,a.receiver,a.amount)}))}});await n.promise()};try{this.currentLoadingState="transfer",await t((async(t,e,a)=>{try{if(a=1e3*parseFloat(a),a<=0)throw new Error("Invalid amount");if(a>this.$store.state.credits.credit)throw new Error("credit_amount_not_enough");if(e===this.$store.state.account.sub)throw new Error("credit_can_not_transfer_to_yourself");await this.$store.dispatch("CREDIT_TRANSFER",{receiverSub:e,amount:a,meta:void 0}),t.hide()}catch(n){this.$q.notify({message:this.$t(n.message),type:"negative",position:"bottom-right",timeout:5e3})}}))}finally{this.currentLoadingState=null}},async receive(){try{this.currentLoadingState="receive";const t=this.$alphabiz.dialog({title:this.$t("receive"),message:this.$t("code_the_receipt_code"),banner:this.$store.state.account.sub,cancel:!0,ok:{color:"primary",textColor:"primary",label:this.$t("copy"),handler:async t=>{await Object(d["b"])(this.$store.state.account.sub),this.$q.notify({message:this.$t("copied"),type:"positive",position:"bottom-right",timeout:5e3}),t.hide()}}});await t.promise()}finally{this.currentLoadingState=null}},async withdrawFund(){try{this.currentLoadingState="withdraw_fund",await this.$store.dispatch("CREDIT_PF_WITHDRAW")}finally{this.currentLoadingState=null}},openBrowser(t){window.open(t,"_blank")}}},h=u,p=(a("6f90"),a("2b5f")),g=a("e586"),m=a("d7c7"),y=a("1043"),b=a("f106"),f=a("cf25"),_=a("fc38"),w=a("90c4"),x=a("09a4"),$=a.n(x),v=Object(p["a"])(h,s,r,!1,null,"7a03469e",null),D=v.exports;$()(v,"components",{QCard:g["a"],QCardSection:m["a"],QBtn:y["a"],QIcon:b["a"],QTooltip:f["a"],QSeparator:_["a"],QBadge:w["a"]});var C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticClass:"full-width",attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-h6 text-weight-bold non-selectable"},[t._v(t._s(t.$t("account_task_page")))])]),a("TaskCard",{staticStyle:{"margin-top":"-16px","min-height":"72px !important"}})],1)},S=[],q={name:"Task"},T=q,k=Object(p["a"])(T,C,S,!1,null,null,null),E=k.exports;$()(k,"components",{QCard:g["a"],QCardSection:m["a"]});var I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticClass:"overflow-hidden",staticStyle:{height:"fit-content","min-height":"240px"},attrs:{bordered:"",flat:""}},[a("q-card-section",{staticClass:"q-pb-none"},[a("div",{staticClass:"text-h6 text-bold non-selectable"},[t._v(t._s(t.$t("income")))])]),a("q-card-section",{staticClass:"q-pb-none"},[a("q-table",{staticStyle:{"margin-top":"-16px"},attrs:{loading:t.loading,"no-data-label":t.$t("credit_no_data"),"loading-label":t.$t("credit_loading"),grid:"","hide-header":"","hide-pagination":"",data:t.tableData,pagination:t.pagination,"row-key":"id"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top",fn:function(){return[a("div",{staticClass:"transaction-header"},[a("div",{staticClass:"full-height full-width relative-position"},[a("alphabiz-button",{attrs:{label:t.$d(t.queryButtonLabel,"YM")}},[a("year-month-picker",{model:{value:t.currentQueryDate,callback:function(e){t.currentQueryDate=e},expression:"currentQueryDate"}})],1)],1)])]},proxy:!0},{key:"item",fn:function(e){return[a("transaction-item",{attrs:{data:e.row},on:{click:t.showDialog}})]}},{key:"bottom",fn:function(){return[a("div",{staticClass:"flex flex-center q-pt-sm q-pb-md full-width"},[a("q-pagination",{attrs:{unelevated:"",color:"general","text-color":"general",max:t.pagesNumber,"max-pages":5,ellipses:!1,"boundary-numbers":!1,"direction-links":"","boundary-links":"",size:"md"},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}})],1)]},proxy:!0}])})],1)],1)},N=[],O=a("7ca3"),Q=a.n(O),A=(a("a1c1"),a("f680")),P=a("1926");class R{static showRaw(t,e){A["a"].create({message:t,type:e,position:"bottom-right",timeout:5e3})}static show(t,e){const a="credit_",n=P["b"].t(a+t.replace(/ /g,"_"));A["a"].create({message:n,type:e,position:"bottom-right",timeout:5e3})}static showPositive(t){this.show(t,"positive")}static showNegative(t){const e=!Object.keys(this.ERROR_EVENTS).includes(t);if(e&&(console.log("======================================================"),console.log("negative::message::raw",t),console.log("======================================================"),t.toString().indexOf("TransactionConflict")>=0))return this.showRaw(P["b"].t("account_error_network"),"negative");e?this.showRaw(t,"negative"):this.show(this.ERROR_EVENTS[t],"negative")}}Q()(R,"ERROR_EVENTS",{"Network error":"error_network","Network Error":"error_network","timeout of 0ms exceeded":"error_network","payer credit amount is not enough":"not_enough_amount","User does not exist.":"payee_not_exist","payee does not exist":"payee_not_exist","Invalid amount":"invalid_amount","can not transfer to yourself":"can_not_transfer_to_yourself"});var L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-popup-proxy",{attrs:{"before-show":t.updateProxyDate,"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{ref:"picker",attrs:{minimal:"",value:t.proxyDate,locale:t.locale,"navigation-max-year-month":t.maxYearMonth,"default-year-month":t.maxYearMonth,mask:"YYYY-MM-DD","default-view":"Months","emit-immediately":!0,"years-in-month-view":!0,color:"general","text-color":"general"},on:{input:t.handleInput}},[a("div",{staticClass:"row items-center justify-end"},t._l([{color:"general",label:t.$t("credit_latest"),handleClick:t.handleLatest},{color:"general",label:t.$t("cancel"),handleClick:function(){}},{color:"primary",label:t.$t("ok"),handleClick:t.handleClick}],(function(t,e){return a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:e,staticClass:"q-mx-xs",attrs:{buttonType:t.buttonType,flat:"primary"!==t.color,unelevated:!0,color:t.color,"text-color":t.color,label:t.label},on:{click:t.handleClick}})})),1)])],1)},F=[],M={name:"YearMonthPicker",props:{value:{type:Date}},data(){const t={proxyDate:null},e=new Date,a=e.getFullYear(),n=e.getMonth()+1;return t.maxYearMonth=`${a}/${n<10?"0":""}${n}`,t},computed:{locale(){const t=[],e=this.$i18n.locale,a=new Date;for(let n=0;n<12;n++)a.setMonth(n),t.push(a.toLocaleString(e,{month:"short"}));return{monthsShort:t}}},created(){this.updateProxyDate()},methods:{updateProxyDate(){var t;const e=null!==(t=this.value)&&void 0!==t?t:new Date;this.proxyDate=`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`},handleInput(t){this.$refs.picker.setView("Months"),this.proxyDate=t},handleClick(){this.$emit("input",new Date(this.proxyDate))},handleLatest(){const t=new Date,e=`${t.getFullYear()}-${t.getMonth()+1}-2`;this.handleInput(e,"latest"),this.handleClick()}}},j=M,Y=a("ff50"),B=a("d49a"),U=a("a431"),H=Object(p["a"])(j,L,F,!1,null,null,null),z=H.exports;$()(H,"components",{QPopupProxy:Y["a"],QDate:B["a"],QBtn:y["a"]}),$()(H,"directives",{ClosePopup:U["a"]});var G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"transaction-item col-xs-12 col-sm-6 col-md-4 non-selectable",attrs:{clickable:""},on:{click:t.handleClick}},[a("q-item-section",{staticClass:"avatar",attrs:{avatar:""}},[a("q-icon",{attrs:{name:t.getTransactionIcon(t.data.category,t.data.isIncome),left:"",size:"2rem"}})],1),a("q-item-section",{staticClass:"main"},[a("q-item-label",{staticClass:"text-weight-bolder text-no-wrap overflow-hidden"},[t._v(t._s(t.$t(t.getCategoryField(t.data.category,t.data.isIncome))))]),a("q-item-label",{staticClass:"text-no-wrap overflow-hidden",attrs:{caption:""}},[t._v(t._s(t.$d(new Date(t.data.time),"MDHms")))])],1),a("q-item-section",{staticClass:"side",attrs:{side:"",top:""}},[a("q-item-label",{staticClass:"amount text-body1 text-weight-bolder",class:t.data.isIncome?"text-positive":"text-general",attrs:{header:""}},[t._v("\n      "+t._s(t.data.amount/1e3)+"\n    ")]),a("q-badge",t._b({staticClass:"status"},"q-badge",t.getBadgeBound(t.data.status),!1))],1)],1)},V=[],W={name:"TransactionItem",props:{data:Object},methods:{handleClick(){this.$emit("click",this.data.id)},getTransactionIcon(t,e){return{TRANSFER:"paid",PAYDATA:e?"cloud_upload":"cloud_download",BONUS:"card_giftcard",RECHARGE:"account_balance_wallet"}[t]},getCategoryField(t,e){return{PAYDATA:e?"category_paydata_payee":"category_paydata_payer",TRANSFER:"category_transfer",BONUS:"category_bonus",RECHARGE:"category_recharge"}[t]},getBadgeBound(t){const e={FINISH:{color:"positive",textColor:"positive",label:this.$t("status_finish")},FAILED:{color:"accent",textColor:"accent",label:this.$t("status_failed")},COMPLETED:{color:"blue",textColor:"white",label:this.$t("status_completed")},PENDING:{color:"general",textColor:"general",label:this.$t("status_pending")}};return e[t]}}},J=W,K=(a("d216"),a("b329")),X=a("25fb"),Z=a("79e0"),tt=a("719b"),et=Object(p["a"])(J,G,V,!1,null,"db95a810",null),at=et.exports;$()(et,"components",{QItem:K["a"],QItemSection:X["a"],QIcon:b["a"],QItemLabel:Z["a"],QBadge:w["a"]}),$()(et,"directives",{Ripple:tt["a"]});a("de6c");var nt=a("e75b"),it={data(){return{sync$listener:st.bind(this)}},methods:{sync$isInRange(t,e){const a=t=>{const e=new Date(t.getUTCFullYear(),t.getUTCMonth(),1),a=new Date(t.getUTCFullYear(),t.getUTCMonth()+1,1);return[e,a]},[n,i]=a(t);return n.getTime()<=e.getTime()&&e.getTime()<=i.getTime()}},created(){nt["a"].GQL.addUserListener("credits",this.sync$listener)},beforeDestroy(){nt["a"].GQL.removeUserListener("credits",this.sync$listener)}};function st(t){const e=t=>!!this.currentQueryDate&&this.sync$isInRange(this.currentQueryDate,"string"===typeof t?new Date(t):t);if(t.dp_expense_txn){const a=t.dp_expense_txn;if(this.expensesTransactions&&e(a.createdAt)){const t=this.expensesTransactions[a.id];t?Object.keys(t).filter((t=>void 0!==a[t])).forEach((e=>t[e]=a[e])):this.expensesTransactions[a.id]=a,this.expensesTransactions=Object.assign({},this.expensesTransactions)}}if(t.dp_income_txn){const a=t.dp_income_txn;if(this.incomeTransactions&&e(a.createdAt)){const t=this.incomeTransactions[a.id];t?Object.keys(t).filter((t=>void 0!==a[t])).forEach((e=>t[e]=a[e])):this.incomeTransactions[a.id]=a,this.incomeTransactions=Object.assign({},this.incomeTransactions)}}if(t.pf_deposit_txn){const a=t.pf_deposit_txn;this.expensesTransactions&&e(a.createdAt)&&(this.expensesTransactions[a.id]=a,this.expensesTransactions=Object.assign({},this.expensesTransactions))}if(t.pf_withdraw_txn){const a=t.pf_withdraw_txn;this.incomeTransactions&&e(a.createdAt)&&(this.incomeTransactions[a.id]=a,this.incomeTransactions=Object.assign({},this.incomeTransactions))}}var rt={name:"Income",mixins:[it,c],components:{YearMonthPicker:z,TransactionItem:at},data(){return{incomeTransactions:{},currentQueryDate:null,loading:!0,pagination:{sortBy:"time",descending:!0,page:1,rowsPerPage:9}}},methods:{showDialog(t){const e=this.tableData.find((e=>e.id===t));this.$alphabiz.dialog({title:this.$t("transaction_details"),list:{items:[{label:this.$t("transaction_id"),caption:e.id},{label:this.$t("transaction_payer"),caption:e.target},{label:this.$t("transaction_category"),caption:this.$t(this.getCategoryField(e.category))},{label:this.$t("transaction_changed_amount"),caption:e.amount/1e3},{label:this.$t("transaction_status"),caption:this.$t(this.getStatus(e.status))},{label:this.$t("transaction_creation_time"),caption:this.$d(new Date(e.time),"YMDHms")},{label:this.$t("transaction_meta"),caption:e.meta}]}})},getCategoryField(t){return{PAYDATA:"category_paydata_payee",TRANSFER:"category_transfer",BONUS:"category_bonus",RECHARGE:"category_recharge"}[t]},getStatus(t){const e={FINISH:"status_finish",FAILED:"status_failed",COMPLETED:"status_completed",PENDING:"status_pending"};return e[t]}},computed:{tableData(){const t=Object.values(this.incomeTransactions);t.sort(((t,e)=>Date.parse(e.createdAt)-Date.parse(t.createdAt)));const e=t=>{const e={};e.time=Date.parse(t.createdAt),e.id=t.id,e.category=t.category,e.amount=`+${t.amount}`,e.status=t.status,e.target=t.payerId,e.isIncome=!0;try{e.meta=JSON.parse(t.meta)}catch(n){var a;e.meta=null!==(a=t.meta)&&void 0!==a?a:null}return e.meta&&"object"===typeof e.meta&&0===Object.keys(e.meta).length&&(e.meta=null),e};return t.map(e)},currentPageNumber(){return this.pagination.page},queryButtonLabel(){return this.currentQueryDate},pagesNumber(){return Math.ceil(this.tableData.length/this.pagination.rowsPerPage)}},mounted(){this.currentQueryDate=new Date},watch:{txn$data(t){this.incomeTransactions=t},async currentPageNumber(t){if(t===this.pagesNumber)try{this.loading=!0,await this.txn$query()}catch(e){R.showNegative(e.message)}finally{this.loading=!1}},async currentQueryDate(t,e){if(!t)return;const a=t=>(t=new Date(t),new Date(t.getUTCFullYear(),t.getUTCMonth()+1,1).toISOString()),n=t=>(t=new Date(t),new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toISOString()),i=e?a(e):null,s=a(t),r=n(t);if(e&&s===i)this.pagination.page=1;else try{this.loading=!0,await this.txn$query("income",{createdAt:{oldest:r,latest:s}})}catch(o){R.showNegative(o.message)}finally{this.loading=!1}}}},ot=rt,ct=(a("c268"),a("8a98")),lt=a("d919"),dt=Object(p["a"])(ot,I,N,!1,null,"cf7c42e8",null),ut=dt.exports;$()(dt,"components",{QCard:g["a"],QCardSection:m["a"],QTable:ct["a"],QPagination:lt["a"]});var ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticStyle:{height:"fit-content","min-height":"240px"},attrs:{bordered:"",flat:""}},[a("q-card-section",{staticClass:"q-pb-none"},[a("div",{staticClass:"text-h6 text-bold non-selectable"},[t._v(t._s(t.$t("expense")))])]),a("q-card-section",{staticClass:"q-pb-none"},[a("q-table",{staticStyle:{"margin-top":"-16px"},attrs:{loading:t.loading,"no-data-label":t.$t("credit_no_data"),"loading-label":t.$t("credit_loading"),grid:"","hide-header":"","hide-pagination":"",data:t.tableData,pagination:t.pagination,"row-key":"id"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top",fn:function(){return[a("div",{staticClass:"transaction-header"},[a("div",{staticClass:"full-height full-width relative-position"},[a("alphabiz-button",{attrs:{label:t.$d(t.queryButtonLabel,"YM")}},[a("year-month-picker",{model:{value:t.currentQueryDate,callback:function(e){t.currentQueryDate=e},expression:"currentQueryDate"}})],1)],1)])]},proxy:!0},{key:"item",fn:function(e){return[a("transaction-item",{attrs:{data:e.row},on:{click:t.showDialog}})]}},{key:"bottom",fn:function(){return[a("div",{staticClass:"flex flex-center q-pt-sm q-pb-md full-width"},[a("q-pagination",{attrs:{unelevated:"",color:"general","text-color":"general",max:t.pagesNumber,"max-pages":5,ellipses:!1,"boundary-numbers":!1,"direction-links":"","boundary-links":"",size:"md"},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}})],1)]},proxy:!0}])})],1)],1)},pt=[],gt={name:"Expense",mixins:[it,c],components:{YearMonthPicker:z,TransactionItem:at},data(){return{expensesTransactions:{},currentQueryDate:null,loading:!0,pagination:{sortBy:"time",descending:!0,page:1,rowsPerPage:9}}},methods:{showDialog(t){const e=this.tableData.find((e=>e.id===t));this.$alphabiz.dialog({title:this.$t("transaction_details"),list:{items:[{label:this.$t("transaction_id"),caption:e.id},{label:this.$t("transaction_payee"),caption:e.target},{label:this.$t("transaction_category"),caption:this.$t(this.getCategoryField(e.category))},{label:this.$t("transaction_changed_amount"),caption:e.amount/1e3},{label:this.$t("transaction_status"),caption:this.$t(this.getStatus(e.status))},{label:this.$t("transaction_creation_time"),caption:this.$d(new Date(e.time),"YMDHms")},{label:this.$t("transaction_meta"),caption:e.meta}]}})},getCategoryField(t){return{PAYDATA:"category_paydata_payer",TRANSFER:"category_transfer",BONUS:"category_bonus",RECHARGE:"category_recharge"}[t]},getStatus(t){const e={FINISH:"status_finish",FAILED:"status_failed",COMPLETED:"status_completed",PENDING:"status_pending"};return e[t]}},computed:{tableData(){const t=Object.values(this.expensesTransactions);t.sort(((t,e)=>Date.parse(e.createdAt)-Date.parse(t.createdAt)));const e=t=>{const e={};e.time=Date.parse(t.createdAt),e.id=t.id,e.category=t.category,e.amount=`-${t.amount}`,e.status=t.status,e.target=t.payeeId;try{e.meta=JSON.parse(t.meta)}catch(n){var a;e.meta=null!==(a=t.meta)&&void 0!==a?a:null}return e.meta&&"object"===typeof e.meta&&0===Object.keys(e.meta).length&&(e.meta=null),e};return t.map(e)},currentPageNumber(){return this.pagination.page},queryButtonLabel(){return this.currentQueryDate},pagesNumber(){return Math.ceil(this.tableData.length/this.pagination.rowsPerPage)}},mounted(){this.currentQueryDate=new Date},watch:{txn$data(t){this.expensesTransactions=t},async currentPageNumber(t){if(t===this.pagesNumber)try{this.loading=!0,await this.txn$query()}catch(e){R.showNegative(e.message)}finally{this.loading=!1}},async currentQueryDate(t,e){if(!t)return;const a=t=>(t=new Date(t),new Date(t.getUTCFullYear(),t.getUTCMonth()+1,1).toISOString()),n=t=>(t=new Date(t),new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toISOString()),i=e?a(e):null,s=a(t),r=n(t);if(e&&s===i)this.pagination.page=1;else try{this.loading=!0,await this.txn$query("expense",{createdAt:{oldest:r,latest:s}})}catch(o){R.showNegative(o.message)}finally{this.loading=!1}}}},mt=gt,yt=(a("b342"),Object(p["a"])(mt,ht,pt,!1,null,"3a95982d",null)),bt=yt.exports;$()(yt,"components",{QCard:g["a"],QCardSection:m["a"],QTable:ct["a"],QPagination:lt["a"]});var ft=a("d310");const _t={beforeRouteEnter(t,e,a){a()}};var wt={name:"Credits",mixins:[_t],components:{Expense:bt,Income:ut,Actions:D,Task:E},data(){return{isElectron:Object(ft["isElectron"])()}},computed:{currentState(){return this.$store.state.account.authState?"signedIn"!==this.$store.state.account.authState?"signedOut":"signedIn":"loading"},currentCredit(){return"signedIn"===this.currentState&&this.$store.state.credits.credit?this.$store.state.credits.credit/1e3:0}},methods:{openBrowser(t){window.open(t,"_blank")}}},xt=wt,$t=(a("3367"),a("9b72")),vt=Object(p["a"])(xt,n,i,!1,null,"377ccc50",null);e["default"]=vt.exports;$()(vt,"components",{QPage:$t["a"]})},3367:function(t,e,a){"use strict";a("fda8")},"6f90":function(t,e,a){"use strict";a("11dc")},8719:function(t,e,a){},a596:function(t,e,a){},aeb9:function(t,e,a){},b342:function(t,e,a){"use strict";a("8719")},c268:function(t,e,a){"use strict";a("aeb9")},d216:function(t,e,a){"use strict";a("a596")},fda8:function(t,e,a){}}]);