(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{1451:function(t,e,a){"use strict";a("6a5e")},"2cae":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{staticClass:"main-layout",attrs:{view:"LHh Lpr lFf"}},[a("application-header",{scopedSlots:t._u([{key:"append",fn:function(){return[t.showCommunities?a("div",{staticClass:"community-btn"},[t.singleCommunity?a("q-btn",{staticClass:"community-btn",attrs:{size:"xs",flat:"",dense:"",rounded:""}},[a("a",{attrs:{href:t.communities[0].url,target:"_blank"}},[a("img",{attrs:{src:t.communities[0].icon,height:"20px"}})])]):a("q-btn-dropdown",{attrs:{size:"sm",flat:"",dense:"",rounded:"","dropdown-icon":"forum","no-icon-animation":""}},[a("q-list",t._l(t.communities,(function(t){return a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t.url+t.icon,attrs:{clickable:"",dense:""}},[a("q-item-section",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:t.url,target:"_blank"}},[a("img",{attrs:{src:t.icon,height:"20px"}})])])],1)})),1)],1)],1):t._e(),a("q-badge",{staticClass:"app-badge app-no-draggable cursor-pointer q-mx-sm non-selectable",attrs:{color:"page","text-color":"page"},on:{click:t.showAboutDialog}},[a("div",{attrs:{id:"version"}},[t._v(t._s("v"+t.publicVersion))]),a("q-separator",{staticClass:"version-separator",attrs:{vertical:""}}),a("div",{attrs:{id:"commit"}},[t._v(t._s(t.publicSourceCommit))])],1)]},proxy:!0}])},[a("template",{slot:"prepend"},[a("q-btn",{staticClass:"app-no-draggable",attrs:{flat:"","fab-mini":"",icon:t.leftDrawerOpen?"menu_open":"menu","aria-label":"Menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}})],1)],2),a("div",{staticClass:"drawer-container"},[a("left-drawer",{ref:"leftDrawer",model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}})],1),a("q-page-container",{staticClass:"bg-page text-page page-container"},[a("keep-alive",{attrs:{include:"Player,Player2,Library,Downloader"}},[a("router-view")],1)],1)],1)},n=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-drawer",{ref:"qDrawer",attrs:{value:t.value,"content-style":"padding-top: 0;position: fixed;left: 0",side:"left","show-if-above":"",breakpoint:t.breakpoint},on:{input:function(e){return t.$emit("input",e)}}},[a("div",{staticClass:"full-height column items-stretch overflow-hidden drawer-content"},[a("div",{staticClass:"left-drawer-header bg-primary text-primary"},[a("q-img",{staticClass:"ab-logo-background ab-logo absolute",staticStyle:{"z-index":"0"},style:t.abLogoStyle,attrs:{src:t.abLogo,contain:""}}),a("corner",{staticClass:"relative-position",staticStyle:{"z-index":"1"}})],1),a("q-scroll-area",{staticClass:"left-drawer-menu",attrs:{"bar-style":{width:"0"},"thumb-style":{width:"0"}}},[a("q-list",{staticClass:"non-selectable"},t._l(t.essentialLinks,(function(e){return a("EssentialLink",t._b({key:e.id||e.title},"EssentialLink",e,!1))})),1)],1)],1)])},o=[],r=(a("de6c"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return!t.children||0===t.children.length&&!t.hide?a("q-item",{staticClass:"drawer-menu-item text-page",attrs:{clickable:"",active:t.isActive,"inset-level":t.level,"active-class":"active-item"},on:{click:t.handleClick}},[t.icon?a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:t.icon}})],1):t._e(),a("q-item-section",[a("q-item-label",[t._v("\n      "+t._s(t.titleString)+"\n    ")])],1),t.badge?[a("q-item-section",{attrs:{side:""}},[a("q-badge",{attrs:{color:"positive","text-color":"positive"}},[t._v(t._s(t.badge))])],1)]:t._e()],2):t.children.length>0&&!t.hide?a("div",[a("q-expansion-item",{staticClass:"text-page",class:{"expansion-menu-item":!0,"active-item":t.isActive},attrs:{"expand-separator":"",icon:t.icon,label:t.titleString,"default-opened":""},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[t.label?a("div",{staticClass:"item-label q-pl-lg q-py-xs text-grey-8"},[t._v(t._s(t.label)+"\n    ")]):t._e(),t._l(t.children,(function(e){return a("EssentialLink",t._b({key:e.id||e.title,attrs:{level:.5}},"EssentialLink",e,!1))}))],2)],1):t._e()}),c=[];function l(t){if(!t)return null;const e="string"===typeof t?{name:t}:t;return e}function d(t,e){if(!e)return!1;const a=t.name===e.name;if(!a)return!1;if(e.query){const a=Object.entries(e.query).some((([e,a])=>t.query[e]!==a));return!a}return!0}var u={name:"EssentialLink",props:{title:{type:[String,Function],required:!0},caption:{type:[String,Function],default:void 0},label:{type:String,default:""},icon:{type:String,default:""},badge:{type:String,default:void 0},route:{type:[String,Object],default:"Index"},query:{type:Object,default:void 0},level:{type:Number,default:0},children:{type:Array,default(){return[]}},hide:Boolean},data(){return{open:!0}},computed:{titleString(){return"string"===typeof this.title?this.title:this.title()},captionString(){if(this.caption)return"string"===typeof this.caption?this.caption:this.caption()},isSelfActive(){const t=l(this.route);return d(this.$route,t)},isChildrenActive(){return this.children.map((t=>t.route)).some((t=>{const e=l(t);return d(this.$route,e)}))},isActive(){return this.open?this.isSelfActive:this.isChildrenActive}},methods:{handleClick(){if(this.isSelfActive&&0===this.children.length)return;const t=l(this.route);t&&this.$router.push(t)}}},h=u,p=(a("1451"),a("2b5f")),m=a("b329"),f=a("25fb"),g=a("f106"),b=a("79e0"),v=a("90c4"),_=a("5bbd"),w=a("4101"),y=a("09a4"),$=a.n(y),C=Object(p["a"])(h,r,c,!1,null,null,null),S=C.exports;$()(C,"components",{QItem:m["a"],QItemSection:f["a"],QIcon:g["a"],QItemLabel:b["a"],QBadge:v["a"],QExpansionItem:_["a"],QColor:w["a"]});var k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"corner-account"},[t.$store.state.account.authState?"signedIn"===t.$store.state.account.authState?[a("div",{staticClass:"corner-account-info"},[a("div",{staticClass:"account-main"},[a("q-avatar",{staticClass:"account-avatar",attrs:{size:"64px"}},[a("q-img",{staticClass:"logo",attrs:{src:t.abLogo,contain:"",width:"48px",height:"48px"}})],1),a("div",{staticClass:"account-info column justify-center"},[a("div",{staticClass:"account-name"},[a("div",[a("span",[t._v(t._s(t.title)+"Â ")]),a("q-tooltip",{attrs:{"content-style":{fontSize:"0.8rem",padding:"2px 8px"},"transition-show":"scale","transition-hide":"scale",anchor:"bottom middle",self:"center start",delay:1e3}},[t._v(t._s(t.title)+"\n              ")])],1),a("q-badge",{attrs:{color:"positive","text-color":"positive",label:t.caption}})],1)])],1),a("div",{staticClass:"account-info-more"},[a("alphabiz-button",{attrs:{icon:"more_horiz","button-type":"icon",color:"primary",size:"0.8rem"}},[a("corner-menu",{on:{signOut:t.requestSignOut,invite:t.invite}})],1)],1)])]:[a("div",{staticClass:"row"},[a("q-avatar",{staticClass:"account-avatar",attrs:{size:"64px"}},[a("q-img",{staticClass:"logo",attrs:{src:t.abLogo,contain:"",width:"48px",height:"48px"}})],1),a("div",{staticClass:"column justify-center q-ml-md"},[a("alphabiz-button",{attrs:{label:t.caption,size:"0.8rem",color:"secondary"},on:{click:function(){return t.$amplify.showSignedOutDialog()}}})],1)],1)]:[a("div",{staticClass:"row"},[a("q-avatar",{staticClass:"account-avatar",attrs:{size:"64px"}},[a("q-spinner",{attrs:{size:"32px"}})],1),a("div",{staticClass:"column justify-center q-ml-md"},[a("div",{staticClass:"account-loading"},[t._v(t._s(t.$t("account_loading")))])])],1)]],2)},q=[],x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-menu",{attrs:{"auto-close":"","touch-position":"","transition-show":"jump-up","transition-hide":"jump-down"}},[a("q-list",{staticClass:"corner-menu__list",staticStyle:{"min-width":"160px"}},[a("q-item",{attrs:{clickable:""},on:{click:function(e){return t.$router.push("/account/settings")}}},[a("q-item-section",{attrs:{"data-cy":"account-settings-btn"}},[t._v("\n          "+t._s(t.$t("account_account_setting"))+"\n        ")])],1),a("q-separator"),a("q-item",{attrs:{clickable:""},on:{click:function(e){return t.$emit("signOut")}}},[a("q-item-section",{attrs:{"data-cy":"sign-out-btn"}},[t._v(t._s(t.$t("account_sign_out"))+"\n        ")])],1)],1)],1)},I=[],Q={name:"CornerMenu",computed:{showInvite(){return this.$store.state.account.invitationCode&&this.$store.state.account.invitationCode.findIndex((t=>0===t.invitation_state))>=0}}},D=Q,U=a("a829"),L=a("e7c2"),O=a("fc38"),P=Object(p["a"])(D,x,I,!1,null,null,null),z=P.exports;$()(P,"components",{QMenu:U["a"],QList:L["a"],QItem:m["a"],QItemSection:f["a"],QSeparator:O["a"]});var j=a("af04"),B=a("c62a6"),E={name:"Corner",data(){return{abLogo:"developer/assets/icon-256.png"}},components:{CornerMenu:z},computed:{info(){return"signedIn"===this.$store.state.account.authState?this.$store.getters.accountUserInfo:null},title(){return this.info?this.info.nickname?this.info.nickname:this.info.emailVerified?this.info.email.split("@")[0]:this.info.phoneNumberVerified?this.info.phoneNumber:"???":this.$t("account_want_to_join")},caption(){return this.info?`Lv. ${this.info.accountLevel}`:this.$t("account_sign_in_now")}},methods:{requestSignOut(){this.$route.path.includes("Setting")?(B["a"].$once("settings-saved",(t=>{if(!t)return console.log("User canceled sign out");B["a"].$emit("request-sign-out")})),B["a"].$emit("request-save-settings")):B["a"].$emit("request-sign-out")},async signOut(){j["a"].showPositive("signed_out"),this.$store.commit("ACCOUNT_UPDATE_STATE","signedOut"),(this.$route.path.startsWith("/account")||this.$route.path.startsWith("/credits"))&&this.$router.push("/"),await this.$store.dispatch("ACCOUNT_SIGN_OUT")},invite(){this.$router.push({path:"/account/settings",query:{call:"invite"}})}},created(){B["a"].$on("confirm-sign-out",(()=>this.signOut()))}},T=E,V=(a("d41d"),a("9f3e")),A=a("53ef"),N=a("9767"),F=a("cf25"),M=Object(p["a"])(T,k,q,!1,null,"de022c26",null),R=M.exports;$()(M,"components",{QAvatar:V["a"],QSpinner:A["a"],QImg:N["a"],QTooltip:F["a"],QBadge:v["a"]});var W=a("5584"),H=a("36a1"),J=a("d310"),G=a("d558"),Y=a("d710"),K=a.n(Y);Object(G["a"])()&&console.log("\n\tYou are running alphabiz app in capacitor mode\n\n");var X={name:"LeftDrawer",components:{EssentialLink:S,Corner:R},props:{value:Boolean,currentTab:String},data(){return{abLogo:"developer/assets/icon-256.png",breakpoint:1080,currentBehavior:null,resizeListener:null,showCreditPage:!1,showBlockchainPage:!1,isCapacitor:Object(G["a"])(),isElectron:Object(J["isElectron"])()}},created(){var t;this.updateCurrentBehavior(),this.resizeListener=t=>this.onWindowResize(t),window.addEventListener("resize",this.resizeListener);const e=null!==(t=localStorage.getItem("dataPaymentMixin.mode"))&&void 0!==t?t:"amplify";this.showCreditPage="amplify"===e,this.showBlockchainPage="blockchain"===e},computed:{abLogoStyle(){const t=Y["theme"].cornerLogoStyle.top;return{...Y["theme"].cornerLogoStyle,top:`calc(${t} + env(safe-area-inset-top) + max(env(safe-area-inset-left), env(safe-area-inset-right)))`}},indexItem(){if(!Object(J["isElectron"])()&&!Object(G["a"])())return{id:"task-management",title:this.$t("task_manage"),icon:"file_download",route:"Downloader"};const t=t=>{const e=W["a"].getters.taskCount[t];if(e)return e.toString()},e={id:"downloading",title:this.$t("downloading"),icon:"file_download",route:{name:"Downloader",query:{currentTab:"downloading"}},badge:t("downloading")},a={id:"uploading",title:this.$t("uploading"),caption:W["a"].getters.isUploadingLoading?this.$t("loading"):null,icon:"file_upload",route:{name:"Downloader",query:{currentTab:"uploading"}},badge:t("uploading")},i={id:"downloaded",title:this.$t("downloaded"),icon:"done",route:{name:"Downloader",query:{currentTab:"downloaded"}},badge:t("downloaded")};return{title:this.$t("download")+"/"+this.$t("upload"),caption:this.$t("home_caption"),icon:"import_export",children:[e,a,i]}},accountSettingItem(){const t=[];return"signedIn"===W["a"].state.account.authState&&t.push({title:this.$t("account_account_setting"),icon:"account_circle",route:"AccountSettings",caption:this.$t("account_setting_caption")}),t},disableDevTools(){return W["a"].getters.settings.disableDevTools},paymentItems(){const t={title:this.$t("credits"),caption:this.$t("credits_caption"),icon:"savings",route:"Credits"},e={title:this.$t("blockchain"),caption:this.$t("blockchain_caption"),icon:"account_balance_wallet",route:"Blockchain"},a=[];return this.showCreditPage&&a.push(t),this.showBlockchainPage&&a.push(e),a},developmentItem(){const t=[];try{W["a"].getters.isDevMode&&t.push({title:this.$t("development"),caption:this.$t("development_caption"),icon:"developer_mode",route:"Development"})}catch(e){}return t},essentialLinks(){const t=!H["a"].isLoggedIn||!H["a"].nonBlockFollowingChannels.length,e={title:this.$t("library"),caption:this.$t("library_caption"),icon:"video_library",children:[{title:this.$t("lib_index"),icon:"home",route:"LibraryIndex"},{title:this.$t("lib_following"),hide:t,icon:"collections_bookmark",route:"LibraryFollowing"},{title:this.$t("lib_local_favorites"),hide:t,icon:"star",route:"LibraryFavorites"},{title:this.$t("lib_publish"),icon:"edit_note",route:"LibraryEdit"}]};H["a"].isLibAdmin&&e.children.push({title:this.$t("take_down"),icon:"block",route:"LibraryTakeDown"});const a=W["a"].getters.settings.libraryShowExplore;(!0===a||"remote"===a&&!0===this.d$cfg.library.show_explore)&&e.children.splice(3,0,{title:this.$t("lib_explore"),hide:t,icon:"travel_explore",route:"LibraryExplore"});const i={id:"drawer-player",title:this.$t("player"),caption:this.$t("player_caption"),icon:"play_circle_filled",route:"Player"},n={title:this.$t("basic_setting"),icon:"assignment",route:"BasicSetting",caption:this.$t("basic_caption")},s={title:this.$t("advanced"),icon:"build",route:"AdvanceSetting",caption:this.$t("advanced")},o={title:this.$t("settings"),caption:this.$t("settings_caption"),icon:"settings",children:[...this.accountSettingItem,n,s]};return[e,this.indexItem,i,...this.paymentItems,o,...this.developmentItem]}},methods:{onWindowResize(){this.updateCurrentBehavior()},updateCurrentBehavior(){const t=window.innerWidth<=this.breakpoint-8?"mobile":"desktop";t!==this.currentBehavior&&(this.currentBehavior=t,this.$refs.qDrawer&&this.$refs.qDrawer.__updateLocal("belowBreakpoint","mobile"===t))}},beforeDestroy(){window.removeEventListener("resize",this.resizeListener)}},Z=X,tt=(a("2f29"),a("ad1a")),et=a("c782"),at=Object(p["a"])(Z,s,o,!1,null,"58e3a24b",null),it=at.exports;$()(at,"components",{QDrawer:tt["a"],QImg:N["a"],QScrollArea:et["a"],QList:L["a"],QColor:w["a"]});var nt=a("ce6c"),st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-header",{staticClass:"bg-primary text-primary app-header"},[a("q-toolbar",{staticClass:"header-toolbar"},[t._t("prepend"),a("Breadcrumbs"),a("q-space"),t._t("append"),t.isElectron&&t.d$cfg.update.enable?a("AppUpdater",{attrs:{source:t.isMicrosoftApp?"microsoft_store":"github"}}):t._e()],2)],1)},ot=[],rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"breadcrumbs q-ml-md"},[a("q-breadcrumbs",{staticClass:"text-primary bread-nowrap",attrs:{gutter:"none"},scopedSlots:t._u([{key:"separator",fn:function(){return[a("q-icon",{staticClass:"breadcrumb-separator",attrs:{name:"chevron_right"}})]},proxy:!0}])},[a("q-breadcrumbs-el",{staticClass:"crumb current-route nowrap",class:{normal:!t.historyPaths.length},on:{click:function(e){t.historyPaths.length&&t.goTo(t.currentPath,0)}}},[a("span",{staticClass:"crumb-label nowrap"},[t._v(t._s(t.currentPath.label))]),a("q-icon",{staticClass:"q-ml-xs breadcrumb-icon",attrs:{name:t.currentPath.icon,size:"1.1em"}})],1),t._l(t.historyPaths,(function(e,i){return a("q-breadcrumbs-el",{key:i,staticClass:"crumb nowrap",class:i===t.history.length-1?"last-crumb":"normal-crumb",attrs:{disable:i===t.history.length-1},on:{click:function(a){return t.goTo(e,i+1)}}},[a("span",{staticClass:"crumb-label nowrap",attrs:{title:e.label}},[t._v("\n        "+t._s(e.label.length>12?e.label.substring(0,11)+"...":e.label)+"\n      ")]),a("q-icon",{staticClass:"q-ml-xs breadcrumb-icon",attrs:{name:e.icon,size:"1.1em"}})],1)}))],2)],1)},ct=[],lt=(a("7a76"),{data(){return{history:[]}},computed:{currentPath(){const t=this.$route.path.split("/")[1],e="downloader"===t?this.$route.query.currentTab:t,a=this.getPathTitle(e),i=this.getPathIcon(e);return{path:"/"+t,label:a,icon:i}},historyPaths(){return this.history.map(((t="")=>{const[e,a]=t.split("?"),i=e.split("/").splice(2);if(!i.length)return null;i.length>1&&console.warn(`The path "${t}" does not have a parser and may update header with something wrong.`);const n=i[0];return n?{path:t,label:this.getPathTitle(n,a),icon:this.getPathIcon(n,a)}:null})).filter((t=>t))}},methods:{parseQS(t=""){const e=Object.create(null);if(!t)return e;for(const a of t.split("&"))if(a.includes("=")){const[t,i]=a.split("=").map((t=>decodeURIComponent(t)));e[t]=i}else e[a]=!0;return e},getPathTitle(t,e=""){var a,i;switch(t){case"downloading":return this.$t("downloading");case"uploading":return this.$t("uploading");case"downloaded":return this.$t("downloaded");case"library":return this.$t("library");case"player":return this.$t("player");case"credits":return this.$t("credits");case"blockchain":return this.$t("blockchain");case"account":return this.$t("account_account_setting");case"basicSetting":return this.$t("basic_setting");case"advanceSetting":return this.$t("advancedSettings");case"development":return this.$t("development");case"creator":return(null===(a=this.parseQS(e))||void 0===a?void 0:a.name)||this.$t("creator");case"channel":return(null===(i=this.parseQS(e))||void 0===i?void 0:i.title)||this.$t("channel");case"following":return this.$t("lib_following");case"edit":return this.$t("lib_publish");case"explore":return this.$t("lib_explore");case"favorite":return this.$t("lib_favorite");case"takedown":return this.$t("take_down");default:return Y["appName"]}},getPathIcon(t){switch(t){case"downloading":return"file_download";case"uploading":return"file_upload";case"downloaded":return"done";case"library":return"video_library";case"player":return"play_circle_filled";case"credits":return"savings";case"blockchain":return"account_balance_wallet";case"account":return"account_circle";case"basicSetting":return"assignment";case"advanceSetting":return"build";case"development":return"developer_mode";case"creator":return"account_circle";case"channel":return"subscriptions";case"following":return"star";case"edit":return"edit_note";case"explore":return"travel_explore";case"favorite":return"folder_special";default:return""}},goTo(t,e){console.log("goto",e,t),e!==this.history.length&&this.$router.push(t.path).then((t=>{t instanceof Error||this.history.splice(e)}))}},watch:{"currentPath.path"(t,e){t!==e&&this.history.splice(0)}},mounted(){this.$root.$on("navigate-to",(t=>{if(!t)return this.history.splice(0);this.history.push(t),this.history.length>2&&this.history.splice(0,this.history.length-2)})),this.$root.$on("update-path",(t=>{var e;console.log("update path",t);const a=null===(e=t.split("?"))||void 0===e?void 0:e[0];for(const i in this.history){const e=parseInt(i);if(isNaN(e))continue;const n=this.history[e];n.startsWith(a+"?")&&this.$set(this.history,e,t)}}))}}),dt=lt,ut=(a("88a6"),a("f29e"),a("c6f0")),ht=a("7a2b"),pt=Object(p["a"])(dt,rt,ct,!1,null,"c0537dc8",null),mt=pt.exports;$()(pt,"components",{QBreadcrumbs:ut["a"],QIcon:g["a"],QBreadcrumbsEl:ht["a"]});var ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"alphabiz-updater"},[a("q-btn",{attrs:{color:"primary","fab-mini":"",flat:""},on:{click:function(){return t.showDialog=!0}}},[t.downloadState?a("div",{staticClass:"absolute-center text-grey-9",staticStyle:{"z-index":"-1"}},[a("q-circular-progress",{attrs:{size:"1.7rem",thickness:.3,"center-color":"white","track-color":"white",value:t.downloadState.total?Math.floor(t.downloadState.downloaded/t.downloadState.total*100):0}}),a("div",{staticClass:"absolute-center text-bold text-black",staticStyle:{"font-size":"0.6rem"}},[t._v("\n        "+t._s(t.downloadState.total?Math.floor(t.downloadState.downloaded/t.downloadState.total*100):0)+"\n      ")]),a("q-tooltip",[t._v(t._s(t.$t("downloading_update")))])],1):[a("q-icon",{attrs:{name:"update"}},[a("q-tooltip",[t._v(t._s(t.$t("check_for_update")))])],1),a("q-badge",{directives:[{name:"show",rawName:"v-show",value:t.latestVersion&&t.latestVersion!==t.currentVersion,expression:"latestVersion && latestVersion !== currentVersion"}],staticClass:"q-mr-xs q-mt-xs",attrs:{color:"yellow",rounded:"",floating:""}})]],2),a("q-dialog",{attrs:{persistent:!t.cancellable,position:t.screen$xs?"bottom":"standard","content-class":"fullscreen-dialog"},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("q-card",{staticClass:"update-panel-card"},[a("q-card-section",{staticClass:"q-pa-md row no-wrap items-center"},[a("div",{staticClass:"text-h6 text-weight-bold ellipsis"},[t._v(t._s(t.$t("update_alphabiz")))]),a("q-space")],1),a("CurrentInformation",{staticClass:"q-pt-none q-pb-xs",attrs:{version:t.currentVersion,source:t.source}}),t.downloadState?a("DownloadState",{staticClass:"q-pt-none q-pb-xs",attrs:{downloaded:t.downloadState.downloaded,total:t.downloadState.total}}):t._e(),a("q-card-section",{staticClass:"q-py-none"},[a("div",{staticClass:"updater-state"},[a("div",{staticClass:"q-px-md q-py-sm row items-center no-wrap",staticStyle:{"min-height":"48px"}},["sniffer$checkUpdate"===t.loadingState?[a("div",{staticClass:"q-pa-xs q-mr-md"},[a("q-spinner-ios",{attrs:{size:"1.1rem"}})],1)]:[a("q-icon",{staticClass:"q-mr-md",attrs:{name:"update",size:"1.7rem"}})],a("div",{staticClass:"full-width"},[["sniffer$checkUpdate","sniffer$checkForceUpdate"].includes(t.loadingState)?[a("div",[t._v(t._s(t.$t("checking_for_update")))])]:t.forceUpdate?[a("div",{staticClass:"text-bold"},[t._v(t._s(t.$t("version_out_of_date")))]),t.latestVersion?a("div",[t._v(t._s(t.latestVersion))]):a("div",{staticStyle:{"font-size":"0.7rem"}},[t._v(t._s(t.$t("have_to_update")))])]:t.latestVersion===t.currentVersion?[a("div",{staticClass:"text-bold"},[t._v(t._s(t.$t("current_is_latest")))]),a("div",[t._v(t._s(t.latestVersion))])]:t.latestVersion?[a("div",{staticClass:"text-bold"},[t._v(t._s(t.$t("new_version_hint")))]),a("div",[t._v(t._s(t.latestVersion))])]:[a("div",[t._v(" "+t._s(t.$t("click_to_check_update")))])]],2)],2),t.release&&t.release.info?a("ReleaseInfomation",{staticClass:"q-pt-none",attrs:{info:t.release.info}}):t._e()],1)]),a("q-card-section",{staticClass:"column"},[t.primaryBtn?a("q-btn",t._b({attrs:{unelevated:"",color:"primary","text-color":"primary","no-caps":""},on:{click:t.primaryBtn.click}},"q-btn",t.primaryBtn,!1)):t._e(),t.cancellable||t.isDev?a("q-btn",{staticClass:"q-mt-sm",attrs:{unelevated:"",color:"general","text-color":"general","no-caps":"",label:t.$t("close")+(!t.cancellable&&t.isDev?" (dev_only)":"")},on:{click:function(){return t.showDialog=!1}}}):t._e()],1)],1)],1)],1)},gt=[],bt=(a("f200"),a("bf73")),vt=a.n(bt);async function _t({currentVersion:t,channel:e}){var a;const i=t=>[t.split("-").shift(),t.split("-").pop()].filter((t=>!!t)).join("-");let n=await(async()=>{try{const t=await(await fetch(K.a.versionsUrl)).json();return t.min[e]}catch(t){return null}})();if(n=i(null!==(a=n)&&void 0!==a?a:t),t=i(t),vt.a.gt(n,t))return n}async function wt(){const{ipcRenderer:t}=await Promise.resolve().then(a.t.bind(null,"1b85",7)),{message:e,release:i}=await new Promise((e=>{const a={message:"version_not_found",release:null};t.once("update-available",((t,{version:i,detail:n})=>{a.message="version_found",a.release={version:i,info:null!==n&&void 0!==n?n:""},e(a)})),t.once("update-not-available",((i,{reason:n,showDialog:s}={})=>{n&&s&&(a.message=n),t.send("dismiss-update"),e(a)})),t.send("check-for-update")}));return{message:e,release:i}}async function yt({onStart:t,onProgress:e,onDownloaded:i,onCancelled:n}){const{ipcRenderer:s}=await Promise.resolve().then(a.t.bind(null,"1b85",7));await new Promise(((a,i)=>{s.once("update-downloading",(()=>{t();const n=(t,a)=>e(a);s.on("update-progress",n),s.once("update-not-available",(()=>i("update-not-available"))),s.once("update-failed",((t,{reason:e})=>i(e))),s.once("ready-to-restart",(()=>a()))})),s.send("confirm-update")})).then((async()=>{await i()}),(async t=>{t&&"update-not-available"!==t&&(await this.$alphabiz.dialog({title:this.$t("update_failed"),message:this.$t("update_failed_message")+this.$t(t),ok:this.$t("ok")}).promise(),await n()),s.send("dismiss-update")})).finally((()=>{s.removeAllListeners("update-progress")}))}const $t=async t=>{const e=`${K.a.homepage}/app/release/${t}.json`;return await fetch(e).then((t=>t.json())).catch((()=>null))};async function Ct({currentVersion:t,channel:e}){var a,i;const n=await $t("microsoft_store"),s=t=>[t.split("-").shift(),t.split("-").pop()].filter((t=>!!t)).join("-");t=s(t);const o=null!==(a=null===n||void 0===n||null===(i=n.min)||void 0===i?void 0:i.version)&&void 0!==a?a:t;if(vt.a.gt(o,t))return o}async function St(t){const e=await $t("microsoft_store"),a={message:"version_not_found"};if(e){const{version:i,information:n}=e.latest;Object.assign(a,{message:vt.a.gt(i,t)?"version_found":"already_latest",release:{version:i,info:null!==n&&void 0!==n?n:""}})}return a}async function kt(){const t=K.a.microsoftStoreProductId,e=`ms-windows-store://pdp/?ProductId=${t}`;window.open(e,"_blank")}var qt={methods:{async sniffer$checkForceUpdate(t){try{this.loadingState="sniffer$checkForceUpdate";const e={microsoft_store:Ct,github:_t}[t],a=await e.call(this,{currentVersion:this.currentVersion,channel:W["a"].getters.settings.versionChannel});return a}finally{this.loadingState=null}},async sniffer$checkUpdate(t){try{this.loadingState="sniffer$checkUpdate";const e={microsoft_store:St,github:wt}[t],{message:a,release:i}=await e.call(this,this.currentVersion),n="version_found"===a;return"already_latest"===a?(this.latestVersion=this.currentVersion,this.release=null):n?(this.latestVersion=i.version,this.release=i):(this.latestVersion=this.currentVersion,this.release=null),{available:n,message:a,release:i}}finally{this.loadingState=null}},async sniffer$startUpdate(t,e){const a={microsoft_store:kt,github:yt}[t];await a.call(this,e)}}},xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card-section",[a("div",{staticClass:"q-px-md q-py-sm bg-general rounded-borders"},[a("div",{staticClass:"q-mr-sm row no-wrap items-center"},[a("div",{staticClass:"text-bold"},[t._v(t._s(t.$t("current_version")))]),t.sourceTag?a("div",{staticClass:"rounded-borders q-ml-sm q-px-sm bg-positive text-positive",staticStyle:{"font-size":"0.7rem"}},[t._v("\n        "+t._s(t.sourceTag)+"\n      ")]):t._e()]),a("div",[t._v(t._s(t.version))])])])},It=[],Qt={name:"CurrentInformation",props:{version:String,source:String},computed:{sourceTag(){return"github"===this.source?null:{microsoft_store:"Microsoft Store"}[this.source]}}},Dt=Qt,Ut=a("d7c7"),Lt=Object(p["a"])(Dt,xt,It,!1,null,null,null),Ot=Lt.exports;$()(Lt,"components",{QCardSection:Ut["a"]});var Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card-section",[a("div",{staticClass:"q-px-md q-py-sm bg-general rounded-borders row no-wrap items-center"},[a("div",{staticClass:"relative-position q-mr-md"},[a("q-circular-progress",{attrs:{size:"1.7rem",thickness:.3,"track-color":"grey","center-color":"transparent",value:t.progress}}),a("div",{staticClass:"absolute-center text-bold",staticStyle:{"font-size":"0.6rem"}},[t._v(t._s(t.progress))])],1),a("div",[a("div",{staticClass:"text-bold"},[t._v(t._s(t.$t("downloading_update")))]),a("div",[t._v(t._s(t.progressMessage))])])])])},zt=[],jt=a("30dc"),Bt=a.n(jt),Et={name:"DownloadState",props:{downloaded:Number,total:Number},computed:{progress(){return this.total?Math.floor(this.downloaded/this.total*100):0},progressMessage(){return`${Bt()(this.downloaded)} / ${Bt()(this.total)}`}}},Tt=Et,Vt=(a("95f2"),a("64e7")),At=Object(p["a"])(Tt,Pt,zt,!1,null,"8d9069a4",null),Nt=At.exports;$()(At,"components",{QCardSection:Ut["a"],QCircularProgress:Vt["a"]});var Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"release-information",on:{click:t.handleClick}},[a("q-separator"),a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"text-bold"},[t._v(t._s(t.$t("release_notes"))+":")]),a("div",{staticClass:"overflow-hidden ellipsis-3-lines",staticStyle:{"white-space":"pre-line"}},[t._v(t._s(t.info))])])],1)},Mt=[],Rt={name:"ReleaseInfomation",props:{info:String},methods:{handleClick(){this.$alphabiz.dialog({title:this.$t("release_notes"),message:this.info,ok:this.$t("cancel")})}}},Wt=Rt,Ht=(a("fe02"),Object(p["a"])(Wt,Ft,Mt,!1,null,"1c23cf1c",null)),Jt=Ht.exports;$()(Ht,"components",{QSeparator:O["a"]});var Gt=a("0f0c");const Yt={data(){return{_downloadNotify:null}},methods:{hideNotify(){this._downloadNotify&&(clearInterval(this._downloadNotify.__interval__),this._downloadNotify(),this._downloadNotify=null)},showNotify(){this.hideNotify();const t=()=>`${this.$t("slow_download_speed_caption")}<br>${this.$d(new Date,"Hms")}`,e=this.$q.notify({spinner:!0,message:this.$t("slow_download_speed"),caption:t(),group:!1,timeout:0,html:!0});e.__interval__=setInterval((()=>{e({caption:t()})}),1e3),this._downloadNotify=e}}};var Kt={name:"AppUpdater",mixins:[qt,Yt],components:{ReleaseInfomation:Jt,DownloadState:Nt,CurrentInformation:Ot},props:{source:String},data(){return{isDev:!1,showDialog:!1,currentVersion:Object(Gt["a"])("version"),latestVersion:null,loadingState:null,release:null,forceUpdate:!1,downloadState:null}},computed:{cancellable(){return!this.forceUpdate},primaryBtn(){return this.downloadState?{label:this.$t("cancel_update"),loading:"cancelUpdate"===this.loadingState,disable:!1,click:async()=>{await this.cancelUpdate(this.source)}}:this.forceUpdate?{label:this.$t("update_now"),disable:!!this.loadingState,click:async()=>{await this.startForceUpdate(this.source)}}:this.latestVersion&&this.latestVersion!==this.currentVersion?{label:this.$t("update_now"),disable:!!this.loadingState,click:async()=>{await this.startUpdate(this.source)}}:{label:this.$t("check_for_update"),disable:!!this.loadingState,click:async()=>{await this.checkUpdate(this.source)}}}},methods:{async checkUpdate(t,e="manual"){const{available:a,message:i}=await this.sniffer$checkUpdate(t);async function n({message:t}){"version_not_found"!==t&&await this.$alphabiz.dialog({title:this.$t("no_update_available"),message:this.$t(t,[this.currentVersion]),ok:this.$t("ok"),cancel:!1}).promise()}"silent"!==e&&"manual"===e&&(a||await n.call(this,{message:i}))},async startUpdate(t){const e=(t,e)=>{const a=setInterval((()=>{t(e),e--,e<0&&clearInterval(a)}),1e3);return()=>clearInterval(a)},a=i.call(this,30,(t=>{t?this.showNotify():this.hideNotify()}));try{this.loadingState="startUpdate",await this.sniffer$startUpdate(t,{onStart:()=>{this.downloadState={downloaded:0,total:0},a.init()},onProgress:t=>{const e=t=>{const e={downloaded:0,total:0};return t?(Object.values(t).filter((t=>!isNaN(t.downloaded)&&!isNaN(t.length))).forEach((t=>{e.downloaded+=t.downloaded,e.total+=t.length})),e):e};this.downloadState=Object.assign({},this.downloadState,e(t)),a.ping()},onDownloaded:async()=>{const a=this.$alphabiz.dialog({title:this.$t("ready_to_update"),banner:this.$t("restart_to_update"),cancel:this.$t("cancel_update"),ok:!1}),i=e((t=>{a.update({cancel:`${this.$t("cancel_update")} (${Math.max(t,0)}s)`})}),15);await a.promise("cancel").then((e=>{e&&(i(),this.cancelUpdate(t))}))},onCancelled:()=>this.downloadState=null})}finally{a.destroy(),this.loadingState=null}function i(t,e){let a=null,i=null;const n=t=>{i&&clearTimeout(i),i=null,e(t)},s=()=>{n(),a=t,i=setTimeout((()=>{a-=1,a>0||n(!0)}),1e3)};return{init:()=>s(),ping:()=>s(),destroy:()=>{null!==a&&n(!1)}}}},async cancelUpdate(t){const e=async()=>{const{ipcRenderer:t}=await Promise.resolve().then(a.t.bind(null,"1b85",7)),e=await new Promise((e=>{t.once("install-aborted",(()=>e("install-aborted"))),t.once("update-aborted",(()=>e("update-aborted"))),t.send("abort-update")}));"install-aborted"===e||(await new Promise((t=>setTimeout(t,3e3))),t.send("dismiss-update"))};try{this.loadingState="cancelUpdate","github"===t&&await e(),this.downloadState=null}finally{this.loadingState=null}},async checkForceUpdate(t,e){const i=!1,n=Object(J["isElectron"])()?a("1b85").ipcRenderer:null,s=await this.sniffer$checkForceUpdate(t);if(!s)return await c.call(this,!1);this.forceUpdate=!0;const o=await r.call(this);if(!o)return await c.call(this,!i);async function r(){const t=this.$alphabiz.dialog({title:this.$t("version_out_of_date"),message:this.$t("have_to_update"),ok:this.$t("update_now"),cancel:i?`${this.$t("cancel")} (dev_only)`:this.$t("exit_alphabiz")});return!await t.promise("cancel")}async function c(t){return t?Object(J["isElectron"])()?(n.send("exit-app"),void setTimeout((()=>process.exit(0)),3e3)):location.reload():W["a"].commit("changeDisableTasks",!1)}e&&await e(s)},async startForceUpdate(t){const{available:e,message:i}=await this.sniffer$checkUpdate();if(!e)return await n.call(this,{message:i});async function n({message:t}){if("version_not_found"===t)return;const e={message:this.$t("download_latest_version_from_website"),cancel:this.$t("cancel"),ok:{label:this.$t("to_the_website"),handler:()=>{if(!Object(J["isElectron"])())return;const t=a("1b85").ipcRenderer,e=K.a.homepage;t.send("to_browserurl",e)}}};await this.$alphabiz.dialog({title:this.$t("no_update_available"),...e}).promise()}await this.startUpdate(t)},async recheckUpdate(t){let e=!1;const a=async()=>{if("github"===t)return!0;if("microsoft_store"===t){var e;const i=await $t("microsoft_store");if(null!==i&&void 0!==i&&null!==(e=i.force_update)&&void 0!==e&&e.enable)return!0;var a;if(i&&i.force_update)return t=null!==(a=i.force_update.source)&&void 0!==a?a:t,i.force_update.enable}};if(await a()&&await this.checkForceUpdate(t,(async()=>{e=!0,this.showDialog=!0,await this.startForceUpdate(t)})),e)return;const i=!!this.latestVersion;i?await this.checkUpdate(t,"silent"):await this.checkUpdate(t,"auto")}},created(){this.recheckUpdate(this.source),J["Bus"].$on("updater$recheckUpdate",(()=>{this.recheckUpdate(this.source)}))}},Xt=Kt,Zt=(a("3285"),a("1043")),te=a("b2aa"),ee=a("e586"),ae=a("990e"),ie=a("7027"),ne=Object(p["a"])(Xt,ft,gt,!1,null,"1fdf356d",null),se=ne.exports;$()(ne,"components",{QBtn:Zt["a"],QCircularProgress:Vt["a"],QTooltip:F["a"],QIcon:g["a"],QBadge:v["a"],QDialog:te["a"],QCard:ee["a"],QCardSection:Ut["a"],QSpace:ae["a"],QSpinnerIos:ie["a"],QColor:w["a"]});var oe=a("3fd2"),re=a.n(oe);const ce=a("d310").isElectron();var le={name:"ApplicationHeader",components:{AppUpdater:se,Breadcrumbs:mt},props:{},data(){return{isElectron:ce,isMicrosoftApp:re.a.windowsStore(),env:null}},created(){if(ce){Promise.resolve().then(a.t.bind(null,"1b85",7)).then((({ipcRenderer:t})=>{this.windowControl=e=>t.sendSync("app_window_control",e)}));const t=navigator.userAgent.toLowerCase(),e=/macintosh|mac os x/i.test(t);this.env=e?"mac":"win"}},computed:{applicationTitle(){const t={Downloader:this.$route.query.currentTab,Library:"library",Player:"player",Credits:"credits",AccountSettings:"account_account_setting",BasicSetting:"basic_setting",AdvanceSetting:"advancedSettings",Development:"development"},e=this.$route.name;return e&&t[e]?this.$t(t[e]):Y["appName"]}}},de=le,ue=(a("f039"),a("832a")),he=a("99c4"),pe=Object(p["a"])(de,st,ot,!1,null,"7d92f264",null),me=pe.exports;$()(pe,"components",{QHeader:ue["a"],QToolbar:he["a"],QSpace:ae["a"]});const fe=a("d310").isElectron();var ge={name:"MainLayout",components:{ApplicationHeader:me,ApplicationBar:nt["a"],LeftDrawer:it},data(){return{showAppBar:fe,communities:"object"===typeof Y["communities"]?Y["communities"]:[],currentTab:"downloading",leftDrawerOpen:!1}},computed:{showCommunities(){return-1!==this.communities.findIndex((t=>t.enable))},singleCommunity(){return 1===this.communities.filter((t=>t.enable)).length},leftDrawerBehavior(){return this.$refs.leftDrawer.currentBehavior},applicationTitle(){const t={Index:this.$route.query.currentTab,Player:"player",Credits:"credits",AccountSettings:"account_account_setting",BasicSettings:"basic_setting",AdvancedSettings:"advancedSettings",Development:"development"},e=this.$route.name;return e&&t[e]?this.$t(t[e]):Y["appName"]},publicVersion(){const t=Object(Gt["a"])("version");if(fe&&re.a.mas())try{var e;const i=process.argv[0],n=a("d6fe").resolve(i,"../../../../../Info.plist"),s=a("bc7b").readFileSync(n,"utf-8"),o=null===(e=s.match(/<key>CFBundleVersion<\/key>\s+<string>\s*(\S+)\s*<\/string>/))||void 0===e?void 0:e[1];if(o)return`${t} (${o})`;console.log("Failed to parse buildVersion from Info.plist. Info:",s)}catch(i){console.log("Failed to parse buildVersion from Info.plist. Error:",i)}if(Object(G["a"])())try{const e=t.split("-")[0];return e}catch(i){console.log("Cannot get mainVersion from",t)}return t},publicSourceCommit(){return Object(Gt["a"])("sourceCommit")}},methods:{showAboutDialog(){J["Bus"].$emit("CALL_ABOUT")}}},be=ge,ve=(a("bea5"),a("f35d")),_e=a("68d7"),we=a("c57c"),ye=a("0daf"),$e=a("a431"),Ce=Object(p["a"])(be,i,n,!1,null,null,null);e["default"]=Ce.exports;$()(Ce,"components",{QLayout:ve["a"],QBtn:Zt["a"],QBtnDropdown:_e["a"],QList:L["a"],QItem:m["a"],QItemSection:f["a"],QBadge:v["a"],QSeparator:O["a"],QPageContainer:we["a"],QFooter:ye["a"],QToolbar:he["a"]}),$()(Ce,"directives",{ClosePopup:$e["a"]})},"2f29":function(t,e,a){"use strict";a("fe76")},3285:function(t,e,a){"use strict";a("bb1a")},"3bf3":function(t,e,a){},"6a5e":function(t,e,a){},"785c":function(t,e,a){},"88a6":function(t,e,a){"use strict";a("3bf3")},"95f2":function(t,e,a){"use strict";a("e988")},bb1a:function(t,e,a){},bd6f:function(t,e,a){},bea5:function(t,e,a){"use strict";a("f10d")},cf38:function(t,e,a){},d41d:function(t,e,a){"use strict";a("cf38")},e6aa:function(t,e,a){},e988:function(t,e,a){},f039:function(t,e,a){"use strict";a("785c")},f10d:function(t,e,a){},f29e:function(t,e,a){"use strict";a("e6aa")},fe02:function(t,e,a){"use strict";a("bd6f")},fe76:function(t,e,a){}}]);